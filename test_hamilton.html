<!DOCTYPE html>
<meta charset="utf-8">
<!-- references: https://bl.ocks.org/mbostock/3886208 -->
<head>
    <link rel="stylesheet" type="text/css" href="themes.css">
</head>

<body>
    <h3> Lyrical Themes in Hamilton </h3>
    <div id="div1"> Whole Musical </div>
    <div id="div2"> By Song </div>


    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script>

    // Theme Name 	Song Name	Start Timestamp (mm:ss)	End Timestamp (mm:ss)	Time Start (sec)	Time End (sec)	Length (sec)  Song Number,    Total Start Seconds
    data =  [
    ["none", "", "", "", 0, 3, 3, 1, 0 ],
    ["How Does",	"Alexander Hamilton",	"0:00:03",	"0:00:18",	3,	18,	16, 1, 3],
    ["none", "", "", "", 18, 77, 77-18, 1, 18 ],
    ["Alexander Hamilton",	"Alexander Hamilton",	"0:01:17",	"0:01:32",	77,	92,	16, 1, 77],
    ["none", "", "", "", 92, 153, 153-92, 1, 92],
    ["In New York",	"Alexander Hamilton",	"0:02:33",	"0:02:44",	153,	164,	12, 1, 153],
    ["Alexander Hamilton",	"Alexander Hamilton",	"0:02:45",	"0:03:56",	165,	236,	72, 1, 165],

    ["none", "", "", "", 0, 13, 13, 2, 236+0 ],
    ["Aaron Burr, Sir",	"Aaron Burr, Sir",	"0:00:13",	"0:00:36",	13,	36,	24,  2, 236+13],
    ["none", "", "", "", 36, 58, 22, 2, 236+36 ],
    ["Talk Less, Smile More",	"Aaron Burr, Sir",	"0:00:58",	"0:01:30",	58,	90,	33, 2, 236+58],
    ["none", "", "", "", 90, 137, 47, 2, 236+90 ],
    ["Stand For Nothing",	"Aaron Burr, Sir",	"0:02:17",	"0:02:31",	137,	151,	15, 2, 236+137]
    ];



    //setup 

    var margin = {top: 20, right: 20, bottom: 30, left: 40},
        width = window.innerWidth,
        height = 100;

    var x_pos_whole_musical = function(d) {
      return d[8];
    };

    var x_pos_by_song = function(d) {
      return d[4];
    };

    var y_pos_by_song = function(d) {
      return d[7]*height;
    };

    var width_of_song = function(d) {
      return d[6];
    };


    var barHeight = 40;
    var numSongs = 2;

    //scaling
    var x = d3.scale.linear()
        .rangeRound([0, width]);

    x.domain([0, d3.max(data, function(d) { return d[5]; })]);

    var color = d3.scale.ordinal()
        .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);
      
    color.domain(d3.keys(data[0]));



    var svg = d3.select("#div1").append("svg")
        .attr("width", width)
        .attr("height", height)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    svg.selectAll("rect")
          .data(data)
        .enter().append("rect")
          .attr("width", function(d) {return width_of_song(d);})
          .attr("x", function(d) {return x_pos_whole_musical(d)})
          .attr("height", function(d) { return barHeight; })
          .style("fill", function(d) { return color(d[0]); });


    var svg_songs = d3.select("#div2").append("svg")
            .attr("width", width)
            .attr("height", height*numSongs*2);

    //for each song, put it in its own g
    for (var ns = 1; ns <= numSongs; ns++) {
        var g = svg_songs.append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        g.selectAll("rect")
            .data(data)
          .enter().append("rect")
            .filter(function(d) { 
              return d[7] == ns;})
            .attr("width", function(d) {return width_of_song(d);})
            .attr("x", function(d) { return x_pos_by_song(d); })
            .attr("y", function(d) { return y_pos_by_song(d); })
            .attr("height", function(d) { return barHeight; })
            .style("fill", function(d) { return color(d[0]); });
        
        // g.selectAll("text")
        //     .data(data)
        //   .enter().append("text")
        //     .filter(function(d, i) {
        //       return d[7] == ns;
        //     })
        //     .attr("x", 20)
        //     .attr("y", function(d) {y_pos_by_song(d)})
        //     .text("Song Name" + ns);
    }

    </script>
</body>